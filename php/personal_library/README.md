 # Личная библиотека книг (Symfony Mini-MVC)

Этот проект представляет собой мини-MVC приложение "Личная библиотека книг", разработанное с использованием Symfony Components.

## Функционал

- Регистрация и авторизация пользователей.
- Главная страница со списком книг:
    - Неавторизованный режим: название, автор, обложка, ссылка на скачивание (если разрешено).
    - Авторизованный режим: то же + ссылки "Редактировать" и "Удалить", ссылка "Добавить книгу" в начале страницы.
- Страница добавления книги с формой: Название, Автор, Обложка (PNG, JPG), Файл с книгой (до 5МБ), Дата прочтения, Галочка "Разрешить скачивание".
- Страница редактирования книги: аналогично добавлению, с предзаполненными данными и возможностью удаления файлов обложки и книги.
- Хранение файлов обложек и книг в поддиректориях (гггг/мм) для избежания конфликтов имен и скопления файлов.
- Сортировка книг на главной странице по дате прочтения (последняя прочитанная - первая).
- Использование PostgreSQL в качестве базы данных.

## Требования

- PHP 8.1 или выше (с расширениями: pgsql, xml, zip, intl, mbstring, curl, dom)
- Composer
- PostgreSQL сервер
- Symfony CLI (опционально, для удобного запуска сервера)

## Установка и запуск

1.  **Клонирование/Загрузка проекта:**
    Загрузите и распакуйте архив с проектом `personal_library.zip` в выбранную вами директорию.
    Или, если это был бы git-репозиторий:
    ```bash
    git clone <repository_url>
    cd personal_library
    ```

2.  **Установка зависимостей:**
    Перейдите в корневую директорию проекта и выполните команду:
    ```bash
    composer install
    ```

3.  **Настройка окружения:**
    Скопируйте файл `.env.example` (если он есть) в `.env` или создайте `.env` вручную. Основной параметр, который нужно настроить — это `DATABASE_URL`.
    Пример для PostgreSQL:
    ```env
    DATABASE_URL="postgresql://db_user:db_password@127.0.0.1:5432/db_name?serverVersion=15&charset=utf8"
    ```
    Замените `db_user`, `db_password`, `127.0.0.1:5432` (если ваш сервер на другом хосте/порту) и `db_name` на ваши актуальные данные.
    Убедитесь, что пользователь `db_user` имеет права на создание базы данных `db_name` или создайте ее вручную.

    Также в проекте используются параметры для директорий загрузки файлов, которые уже настроены в `config/services.yaml` и используют `%kernel.project_dir%/public/uploads/`:
    - `covers_directory: "%kernel.project_dir%/public/uploads/covers"`
    - `books_directory: "%kernel.project_dir%/public/uploads/books"`
    Эти директории будут создаваться автоматически при первой загрузке файла в соответствующую поддиректорию (гггг/мм).

4.  **Создание базы данных и миграции:**
    Выполните следующие команды для создания базы данных (если она еще не создана) и применения миграций (создания таблиц):
    ```bash
    php bin/console doctrine:database:create --if-not-exists
    php bin/console doctrine:migrations:migrate
    ```
    Если вы предпочитаете обновить схему напрямую (не рекомендуется для production, но допустимо для разработки):
    ```bash
    php bin/console doctrine:schema:update --force
    ```

5.  **Создание директорий для загрузок (если не создаются автоматически):
    Директории `public/uploads/covers` и `public/uploads/books` (и их поддиректории по датам) должны создаваться автоматически при загрузке файлов. Если возникнут проблемы с правами, убедитесь, что веб-сервер имеет права на запись в директорию `public/uploads/`.

6.  **Запуск сервера разработки:**
    Вы можете использовать встроенный веб-сервер PHP или Symfony CLI.

    С помощью Symfony CLI (рекомендуется):
    ```bash
    symfony server:start
    ```
    Приложение будет доступно по адресу, указанному в выводе команды (обычно `http://127.0.0.1:8000`).

    С помощью встроенного PHP сервера:
    ```bash
    php -S localhost:8000 -t public
    ```
    Приложение будет доступно по адресу `http://localhost:8000`.

## Использование

- Перейдите на главную страницу.
- Зарегистрируйтесь для получения доступа к полному функционалу.
- Добавляйте, редактируйте и удаляйте книги из вашей личной библиотеки.

## Структура проекта (основные директории)

- `config/`: Конфигурационные файлы Symfony.
- `public/`: Корневая директория веб-сервера, содержит `index.php` и загруженные файлы.
- `src/`: Исходный код приложения PHP.
    - `Controller/`: Контроллеры.
    - `Entity/`: Сущности Doctrine.
    - `Form/`: Классы форм.
    - `Repository/`: Репозитории Doctrine.
    - `Security/`: Классы, связанные с безопасностью.
- `templates/`: Шаблоны Twig.
- `var/`: Кэш, логи и другие временные файлы.

Приятного использования!

